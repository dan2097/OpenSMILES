<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>OpenSMILES specification</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /></head><body><div xml:lang="en" class="article" title="OpenSMILES specification" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="idp25136480"></a>OpenSMILES specification</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Craig</span> <span class="othername">A.</span> <span class="surname">James</span></h3></div></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 1.0</td><td align="left">2012-29-09</td><td align="left">CAJ</td></tr><tr><td align="left" colspan="3">Current specification</td></tr></table></div></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="#_introduction">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#_purpose">1.1. Purpose</a></span></dt><dt><span class="section"><a href="#_motivation">1.2. Motivation</a></span></dt><dt><span class="section"><a href="#_audience">1.3. Audience</a></span></dt><dt><span class="section"><a href="#_what_is_a_molecule_the_valence_model_of_chemistry">1.4. What is a Molecule? The Valence Model of Chemistry</a></span></dt></dl></dd><dt><span class="section"><a href="#_formal_grammar">2. Formal Grammar</a></span></dt><dd><dl><dt><span class="section"><a href="#_syntax_versus_semantics">2.1. Syntax versus Semantics</a></span></dt><dt><span class="section"><a href="#_grammar">2.2. Grammar</a></span></dt></dl></dd><dt><span class="section"><a href="#_reading_smiles">3. Reading SMILES</a></span></dt><dd><dl><dt><span class="section"><a href="#inatoms">3.1. Atoms</a></span></dt><dt><span class="section"><a href="#bonds">3.2. Bonds</a></span></dt><dt><span class="section"><a href="#_branches">3.3. Branches</a></span></dt><dt><span class="section"><a href="#ringclosure">3.4. Rings</a></span></dt><dt><span class="section"><a href="#inaromaticity">3.5. Aromaticity</a></span></dt><dt><span class="section"><a href="#_more_about_hydrogen">3.6. More about Hydrogen</a></span></dt><dt><span class="section"><a href="#_disconnected_structures">3.7. Disconnected Structures</a></span></dt><dt><span class="section"><a href="#chirality">3.8. Stereochemistry</a></span></dt><dt><span class="section"><a href="#_parsing_termination">3.9. Parsing Termination</a></span></dt><dt><span class="section"><a href="#_programming_practices">3.10. Programming Practices</a></span></dt></dl></dd><dt><span class="section"><a href="#normalization">4. Writing SMILES: Normalizations</a></span></dt><dd><dl><dt><span class="section"><a href="#_what_is_normalization">4.1. What is Normalization?</a></span></dt><dt><span class="section"><a href="#_no_normalization">4.2. No Normalization</a></span></dt><dt><span class="section"><a href="#standardform">4.3. Standard Form</a></span></dt><dt><span class="section"><a href="#canonicalization">4.4. Canonical SMILES</a></span></dt><dt><span class="section"><a href="#_smiles_files">4.5. SMILES Files</a></span></dt></dl></dd><dt><span class="section"><a href="#nonstandard">5. Nonstandard Forms of SMILES</a></span></dt><dt><span class="section"><a href="#_proposed_extensions">6. Proposed Extensions</a></span></dt><dd><dl><dt><span class="section"><a href="#_external_r_groups">6.1. External R-Groups</a></span></dt><dt><span class="section"><a href="#_polymers_and_crystals">6.2. Polymers and Crystals</a></span></dt><dt><span class="section"><a href="#_literal_literal_for_cis_trans_around_double_bonds">6.3. <code class="literal">'@'</code> for Cis/Trans around Double Bonds</a></span></dt><dt><span class="section"><a href="#_radical">6.4. Radical</a></span></dt><dt><span class="section"><a href="#_twisted_smiles">6.5. Twisted SMILES</a></span></dt></dl></dd><dt><span class="section"><a href="#appendix">7. APPENDIX 1: References and Citations</a></span></dt><dd><dl><dt><span class="section"><a href="#_groups">7.1. Groups</a></span></dt><dt><span class="section"><a href="#_documentation">7.2. Documentation</a></span></dt><dt><span class="section"><a href="#_toolkits">7.3. Toolkits</a></span></dt><dt><span class="section"><a href="#_some_key_scientific_papers">7.4. Some Key Scientific Papers</a></span></dt><dt><span class="section"><a href="#_molecule_editors_that_can_produce_smiles">7.5. Molecule Editors that can produce SMILES</a></span></dt></dl></dd><dt><span class="section"><a href="#_revision_history">8. Revision History</a></span></dt></dl></div><p><a class="ulink" href="http://www.opensmiles.org" target="_top">www.opensmiles.org</a></p><p>Copyright © 2007, Craig A. James</p><p>Content is available under <a class="ulink" href="http://www.gnu.org/copyleft/fdl.html" target="_top">GNU Free Documentation License 1.2</a></p><p>Contributors: Richard Apodaca, Noel O’Boyle, Andrew Dalke, John van Drie, Peter Ertl,
Geoff Hutchison, Craig A. James, Greg Landrum, Chris Morley, Egon Willighagen, Hans De Winter,
Tim Vandermeersch</p><div class="section" title="1. Introduction"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_introduction"></a>1. Introduction</h2></div></div></div><div class="sidebar"><div class="titlepage"></div><p>"… we cannot improve the language of any science, without, at the
same time improving the science itself; neither can we, on the other
hand, improve a science, without improving the language or nomenclature
which belongs to it …"</p><p><a class="ulink" href="http://en.wikipedia.org/wiki/Antoine_Lavoisier" target="_top">Antoine Lavoiser, 1787</a></p></div><div class="section" title="1.1. Purpose"><div class="titlepage"><div><div><h3 class="title"><a id="_purpose"></a>1.1. Purpose</h3></div></div></div><p>This document formally defines an
<a class="ulink" href="http://en.wikipedia.org/wiki/Open_specifications" target="_top">open specification</a> version of the
<a class="ulink" href="http://en.wikipedia.org/wiki/Simplified_molecular_input_line_entry_specification" target="_top">SMILES</a>
language, a typographical <a class="ulink" href="http://en.wikipedia.org/wiki/Line_notation" target="_top">line notation</a>
for specifying chemical structure.  It is hosted under the banner of the
<a class="ulink" href="http://blueobelisk.sourceforge.net" target="_top">Blue Obelisk</a>
project, with the intent to solicit contributions and comments from the
entire computational chemistry community.</p></div><div class="section" title="1.2. Motivation"><div class="titlepage"><div><div><h3 class="title"><a id="_motivation"></a>1.2. Motivation</h3></div></div></div><p>SMILES was originally developed as a proprietary specification by
<a class="ulink" href="http://www.daylight.com" target="_top">Daylight Chemical Information Systems</a>
Since the introduction of SMILES in the late 1980’s, it has
become widely accepted as a defacto standard for exchange of molecular structures.  Many independent
SMILES software packages have been written in <code class="literal">C</code>, <code class="literal">C++</code>, <code class="literal">Java</code>, <code class="literal">Python</code>, <code class="literal">LISP</code>, and probably even
<code class="literal">FORTRAN</code>.</p><p>At this point in the history of SMILES, is appropriate for the chemistry community
to develop a new, non-proprietary specification for the SMILES language.  Daylight’s
<a class="ulink" href="http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html" target="_top">SMILES Theory Manual</a>
has long been the "gold standard" for the SMILES language, but as a
proprietary specification, it limits the universal adoption of SMILES, and has no
mechanism for contributions from the chemistry community.  We salute Daylight for
their past contributions, and the excellent SMILES documentation they provided free
of charge for the past two decades.</p></div><div class="section" title="1.3. Audience"><div class="titlepage"><div><div><h3 class="title"><a id="_audience"></a>1.3. Audience</h3></div></div></div><p>This document is intended for developers designing or improving a SMILES
parser or writer. <span class="strong"><strong>Readers are expected to be acquainted with
SMILES.</strong></span> Due to the formality of this document, it is not a good
tutorial for those trying to learn SMILES. This document is written with
<span class="strong"><strong>precision</strong></span> as the primary goal; <span class="strong"><strong>readability</strong></span> is secondary.</p></div><div class="section" title="1.4. What is a Molecule? The Valence Model of Chemistry"><div class="titlepage"><div><div><h3 class="title"><a id="_what_is_a_molecule_the_valence_model_of_chemistry"></a>1.4. What is a Molecule? The Valence Model of Chemistry</h3></div></div></div><p>Before defining the SMILES language, it is important to state the physical model on which it is
based: the valence model of chemistry, which uses a mathematician’s
<a class="ulink" href="http://en.wikipedia.org/wiki/Graph_%28mathematics%29" target="_top">graph</a> to
represent a molecule.  In a chemical graph, the <span class="strong"><strong>nodes</strong></span>
are atoms, and the <span class="strong"><strong>edges</strong></span> are semi-rigid bonds that can be single, double, or
triple according to the rules of
<a class="ulink" href="http://en.wikipedia.org/wiki/Valence_bond_theory" target="_top">valence bond theory</a>.</p><p>This simple mental model has little resemblance to the underlying quantum-mechanical reality of
electrons, protons and neutrons, yet it has proved to be a remarkably useful approximation of how
atoms behave in close proximity to one another.  However, the valence model is an imperfect
representation of molecular structure, and the SMILES language inherits these imperfections.
Chemical bonds are often tautomeric, aromatic or otherwise fractional rather than neat integer
multiples.  Delocalized bonds, bond-centered bonds, hydrogen bonds and various other inter-atom
forces that are well characterized by a quantum-mechanics description simply don’t fit into the
valence model.</p><div class="sidebar"><div class="titlepage"></div><p>"If you can build a molecule from a modeling kit, you can name it."</p><p><a class="ulink" href="http://www.daylight.com/meetings/mug03/McLeod/MUG03McLeodPeters.pdf" target="_top">McLeod Peters</a></p></div><p>McLeod and Peter’s quip captures the deficiencies of SMILES well: if you
<span class="strong"><strong>can’t</strong></span> build a molecule from a modeling kit, the deficiencies of SMILES and other
connection-table formats become apparent.</p></div></div><div class="section" title="2. Formal Grammar"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_formal_grammar"></a>2. Formal Grammar</h2></div></div></div><div class="section" title="2.1. Syntax versus Semantics"><div class="titlepage"><div><div><h3 class="title"><a id="_syntax_versus_semantics"></a>2.1. Syntax versus Semantics</h3></div></div></div><p>This SMILES specification is divided into two distinct parts: A
<span class="strong"><strong>syntactic specification</strong></span> specifies how the atoms,
bonds, parentheses, digits and so forth are represented, and a <span class="strong"><strong>semantic
specification</strong></span> that describes how those symbols are interpreted as a sensible
molecule.  For example, the syntax specifies how <a class="link" href="#ringclosure" title="3.4. Rings">ring closures</a>
are written, but the semantics require that they come in pairs.
Likewise, the syntax specifies how <a class="link" href="#atomicsymbol" title="Atomic Symbol">atomic elements</a>
are written, but the semantics determines whether a particular ring system
is actually aromatic.</p><p>For this specification, the syntax and semantics are explained
separately; in practice, the syntax and semantics are usually mixed
together in the code that implements a SMILES parser.  This chapter is only
concerned with syntax.</p></div><div class="section" title="2.2. Grammar"><div class="titlepage"><div><div><h3 class="title"><a id="_grammar"></a>2.2. Grammar</h3></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Section                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Formal Grammar</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>ATOMS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><a class="link" href="#inatoms" title="3.1. Atoms">Atoms</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>atom</em></span> ::= <span class="emphasis"><em>bracket_atom</em></span> | <span class="emphasis"><em>aliphatic_organic</em></span> | <span class="emphasis"><em>aromatic_organic</em></span> | <code class="literal">'*'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>ORGANIC SUBSET ATOMS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><a class="link" href="#orgsbst" title="Organic Subset">Organic Subset</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>aliphatic_organic</em></span> ::= <code class="literal">'B'</code> | <code class="literal">'C'</code> | <code class="literal">'N'</code> | <code class="literal">'O'</code> | <code class="literal">'S'</code> | <code class="literal">'P'</code> | <code class="literal">'F'</code> | <code class="literal">'Cl'</code> | <code class="literal">'Br'</code> | <code class="literal">'I'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>aromatic_organic</em></span> ::= <code class="literal">'b'</code> | <code class="literal">'c'</code> | <code class="literal">'n'</code> | <code class="literal">'o'</code> | <code class="literal">'s'</code> | <code class="literal">'p'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>BRACKET ATOMS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="5" align="left" valign="top"><p><a class="link" href="#inatoms" title="3.1. Atoms">Bracket Atoms</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>bracket_atom</em></span> ::= <code class="literal">'['</code> <span class="emphasis"><em>isotope</em></span>? <span class="emphasis"><em>symbol</em></span> <span class="emphasis"><em>chiral</em></span>? <span class="emphasis"><em>hcount</em></span>? <span class="emphasis"><em>charge</em></span>? <span class="emphasis"><em>class</em></span>? <code class="literal">']'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>symbol</em></span> ::= <span class="emphasis"><em>element_symbols</em></span> | <span class="emphasis"><em>aromatic_symbols</em></span> | <code class="literal">'*'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>isotope</em></span> ::= <span class="emphasis"><em>NUMBER</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>element_symbols</em></span> ::= <code class="literal">'H'</code> | <code class="literal">'He'</code> | <code class="literal">'Li'</code> | <code class="literal">'Be'</code> | <code class="literal">'B'</code> | <code class="literal">'C'</code> | <code class="literal">'N'</code> | <code class="literal">'O'</code> | <code class="literal">'F'</code> | <code class="literal">'Ne'</code> | <code class="literal">'Na'</code> | <code class="literal">'Mg'</code> | <code class="literal">'Al'</code> | <code class="literal">'Si'</code> | <code class="literal">'P'</code> | <code class="literal">'S'</code> | <code class="literal">'Cl'</code> | <code class="literal">'Ar'</code> | <code class="literal">'K'</code> | <code class="literal">'Ca'</code> | <code class="literal">'Sc'</code> | <code class="literal">'Ti'</code> | <code class="literal">'V'</code> | <code class="literal">'Cr'</code> | <code class="literal">'Mn'</code> | <code class="literal">'Fe'</code> | <code class="literal">'Co'</code> | <code class="literal">'Ni'</code> | <code class="literal">'Cu'</code> | <code class="literal">'Zn'</code> | <code class="literal">'Ga'</code> | <code class="literal">'Ge'</code> | <code class="literal">'As'</code> | <code class="literal">'Se'</code> | <code class="literal">'Br'</code> | <code class="literal">'Kr'</code> | <code class="literal">'Rb'</code> | <code class="literal">'Sr'</code> | <code class="literal">'Y'</code> | <code class="literal">'Zr'</code> | <code class="literal">'Nb'</code> | <code class="literal">'Mo'</code> | <code class="literal">'Tc'</code> | <code class="literal">'Ru'</code> | <code class="literal">'Rh'</code> | <code class="literal">'Pd'</code> | <code class="literal">'Ag'</code> | <code class="literal">'Cd'</code> | <code class="literal">'In'</code> | <code class="literal">'Sn'</code> | <code class="literal">'Sb'</code> | <code class="literal">'Te'</code> | <code class="literal">'I'</code> | <code class="literal">'Xe'</code> | <code class="literal">'Cs'</code> | <code class="literal">'Ba'</code> | <code class="literal">'Hf'</code> | <code class="literal">'Ta'</code> | <code class="literal">'W'</code> | <code class="literal">'Re'</code> | <code class="literal">'Os'</code> | <code class="literal">'Ir'</code> | <code class="literal">'Pt'</code> | <code class="literal">'Au'</code> | <code class="literal">'Hg'</code> | <code class="literal">'Tl'</code> | <code class="literal">'Pb'</code> | <code class="literal">'Bi'</code> | <code class="literal">'Po'</code> | <code class="literal">'At'</code> | <code class="literal">'Rn'</code> | <code class="literal">'Fr'</code> | <code class="literal">'Ra'</code> | <code class="literal">'Rf'</code> | <code class="literal">'Db'</code> | <code class="literal">'Sg'</code> | <code class="literal">'Bh'</code> | <code class="literal">'Hs'</code> | <code class="literal">'Mt'</code> | <code class="literal">'Ds'</code> | <code class="literal">'Rg'</code> | <code class="literal">'Cn'</code> | <code class="literal">'Fl'</code> | <code class="literal">'Lv'</code> | <code class="literal">'La'</code> | <code class="literal">'Ce'</code> | <code class="literal">'Pr'</code> | <code class="literal">'Nd'</code> | <code class="literal">'Pm'</code> | <code class="literal">'Sm'</code> | <code class="literal">'Eu'</code> | <code class="literal">'Gd'</code> | <code class="literal">'Tb'</code> | <code class="literal">'Dy'</code> | <code class="literal">'Ho'</code> | <code class="literal">'Er'</code> | <code class="literal">'Tm'</code> | <code class="literal">'Yb'</code> | <code class="literal">'Lu'</code> | <code class="literal">'Ac'</code> | <code class="literal">'Th'</code> | <code class="literal">'Pa'</code> | <code class="literal">'U'</code> | <code class="literal">'Np'</code> | <code class="literal">'Pu'</code> | <code class="literal">'Am'</code> | <code class="literal">'Cm'</code> | <code class="literal">'Bk'</code> | <code class="literal">'Cf'</code> | <code class="literal">'Es'</code> | <code class="literal">'Fm'</code> | <code class="literal">'Md'</code> | <code class="literal">'No'</code> | <code class="literal">'Lr'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>aromatic_symbols</em></span> ::= <code class="literal">'b'</code> | <code class="literal">'c'</code> | <code class="literal">'n'</code> | <code class="literal">'o'</code> | <code class="literal">'p'</code> | <code class="literal">'s'</code> | <code class="literal">'se'</code> | <code class="literal">'as'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>CHIRALITY</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><a class="link" href="#chirality" title="3.8. Stereochemistry">Chirality</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>chiral</em></span> ::= <code class="literal">'@'</code> | <code class="literal">'@@'</code> | <code class="literal">'@TH1'</code> | <code class="literal">'@TH2'</code> | <code class="literal">'@AL1'</code> | <code class="literal">'@AL2'</code> | <code class="literal">'@SP1'</code> | <code class="literal">'@SP2'</code> | <code class="literal">'@SP3'</code> | <code class="literal">'@TB1'</code> | <code class="literal">'@TB2'</code> | <code class="literal">'@TB3'</code> | … | <code class="literal">'@TB20'</code> | <code class="literal">'@OH1'</code> | <code class="literal">'@OH2'</code> | <code class="literal">'@OH3'</code> | … | <code class="literal">'@OH30'</code> | <code class="literal">'@TB'</code> <span class="emphasis"><em>DIGIT</em></span> <span class="emphasis"><em>DIGIT</em></span> | <code class="literal">'@OH'</code> <span class="emphasis"><em>DIGIT</em></span> <span class="emphasis"><em>DIGIT</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>HYDROGENS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><a class="link" href="#hydrogens" title="Hydrogens">Hydrogens</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>hcount</em></span> ::= <code class="literal">'H'</code> | <code class="literal">'H'</code> <span class="emphasis"><em>DIGIT</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>CHARGES</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><a class="link" href="#charge" title="Charge">Charge</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>charge</em></span> ::= <code class="literal">'-'</code> | <code class="literal">'-'</code> <span class="emphasis"><em>DIGIT</em></span>? <span class="emphasis"><em>DIGIT</em></span> | <code class="literal">'+'</code> | <code class="literal">'+'</code> <span class="emphasis"><em>DIGIT</em></span>? <span class="emphasis"><em>DIGIT</em></span> | <code class="literal">'--'</code> <span class="strong"><strong>deprecated</strong></span>  | <code class="literal">'++'</code> <span class="strong"><strong>deprecated</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>ATOM CLASS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><a class="link" href="#atomclass" title="Atom Class">Atom Class</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>class</em></span> ::= <code class="literal">':'</code> <span class="emphasis"><em>NUMBER</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>BONDS AND CHAINS</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="6" align="left" valign="top"><p><a class="link" href="#bonds" title="3.2. Bonds">Bonds</a></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>bond</em></span> ::= <code class="literal">'-'</code> | <code class="literal">'='</code> | <code class="literal">'#'</code> | <code class="literal">'$'</code> | <code class="literal">':'</code> | <code class="literal">'/'</code> | <code class="literal">'\'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>ringbond</em></span> ::= <span class="emphasis"><em>bond</em></span>? <span class="emphasis"><em>DIGIT</em></span> | <span class="emphasis"><em>bond</em></span>? <code class="literal">'%'</code> <span class="emphasis"><em>DIGIT</em></span> <span class="emphasis"><em>DIGIT</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>branched_atom</em></span> ::= <span class="emphasis"><em>atom</em></span> <span class="emphasis"><em>ringbond</em></span>* <span class="emphasis"><em>branch</em></span>*</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>branch</em></span> ::= <code class="literal">'('</code> <span class="emphasis"><em>chain</em></span> <code class="literal">')'</code> | <code class="literal">'('</code> <span class="emphasis"><em>bond</em></span> <span class="emphasis"><em>chain</em></span> <code class="literal">')'</code> | <code class="literal">'('</code> <span class="emphasis"><em>dot</em></span> <span class="emphasis"><em>chain</em></span> <code class="literal">')'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>chain</em></span> ::= <span class="emphasis"><em>branched_atom</em></span> | <span class="emphasis"><em>chain</em></span> <span class="emphasis"><em>branched_atom</em></span> | <span class="emphasis"><em>chain</em></span> <span class="emphasis"><em>bond</em></span> <span class="emphasis"><em>branched_atom</em></span> | <span class="emphasis"><em>chain</em></span> <span class="emphasis"><em>dot</em></span> <span class="emphasis"><em>branched_atom</em></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>dot</em></span> ::= <code class="literal">'.'</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"><p><span class="strong"><strong>SMILES STRINGS</strong></span></p></td></tr><tr><td style="" rowspan="2" align="left" valign="top"><p></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="emphasis"><em>smiles</em></span> ::= <span class="emphasis"><em>terminator</em></span> | <span class="emphasis"><em>chain</em></span> <span class="emphasis"><em>terminator</em></span></p></td></tr><tr><td style="" align="left" valign="top"><p><span class="emphasis"><em>terminator</em></span> ::= <span class="emphasis"><em>SPACE</em></span> | <span class="emphasis"><em>TAB</em></span> | <span class="emphasis"><em>LINEFEED</em></span> | <span class="emphasis"><em>CARRIAGE_RETURN</em></span> | <span class="emphasis"><em>END_OF_STRING</em></span></p></td></tr></tbody></table></div></div></div><div class="section" title="3. Reading SMILES"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_reading_smiles"></a>3. Reading SMILES</h2></div></div></div><div class="section" title="3.1. Atoms"><div class="titlepage"><div><div><h3 class="title"><a id="inatoms"></a>3.1. Atoms</h3></div></div></div><div class="section" title="Atomic Symbol"><div class="titlepage"><div><div><h4 class="title"><a id="atomicsymbol"></a>Atomic Symbol</h4></div></div></div><p>An atom is represented by its atomic symbol, enclosed in square brackets, <code class="literal">[]</code>.
The first character of the symbol is uppercase and the second (if any) is lowercase,
except that for aromatic atoms (see below), the first character is lowercase.  There are
<a class="ulink" href="http://www.iupac.org/reports/provisional/abstract04/RB-prs310804/TableI-3.04.pdf" target="_top">114 valid atomic symbols</a>
, as defined by <a class="ulink" href="http://www.iupac.org" target="_top">IUPAC</a> (see also
<a class="ulink" href="http://www.webelements.com" target="_top">Web Elements</a>).</p><p>The symbol <code class="literal">'*'</code> is also accepted as a valid atomic symbol, and represents a "wildcard" or unknown atom.</p><p>Examples:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="30%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Atomic Symbol</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[U]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Uranium</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Pb]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Lead</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[He]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Helium</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[*]</code></p></td><td style="" align="left" valign="top"><p>Unkwown atom</p></td></tr></tbody></table></div></div><div class="section" title="Hydrogens"><div class="titlepage"><div><div><h4 class="title"><a id="hydrogens"></a>Hydrogens</h4></div></div></div><p>Hydrogens inside of brackets are specified as <code class="literal">Hn</code> where <code class="literal">n</code> is a number such as <code class="literal">H3</code>.  If no
<code class="literal">Hn</code> is specified, it is identical to <code class="literal">H0</code>. If <code class="literal">H</code> is
specified without a number, it is identical to <code class="literal">H1</code>.  For example, <code class="literal">[C]</code> and
<code class="literal">[CH0]</code> are identical, and <code class="literal">[CH]</code> and <code class="literal">[CH1]</code> are identical.</p><p>Hydrogens that are specified in brackets with this notation have undefined isotope, no chirality,
no other bound hydrogen, neutral charge, and an undefined atom class.</p><p>Examples:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="50%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comments</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH4]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[ClH]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>hydrochloric acid</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">H1</code> implied</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[ClH1]</code></p></td><td style="" align="left" valign="top"><p>hydrochloric acid</p></td><td style="" align="left" valign="top"><p></p></td></tr></tbody></table></div><p>A hydrogen atom cannot have a hydrogen count, for example, <code class="literal">[HH1]</code> is illegal.  Hydrogens connected
to other hydrogens must be represented as explicit atoms in square brackets. For example molecular
hydrogen must be written as <code class="literal">[H][H]</code>.</p><p><span class="emphasis"><em>Question: are more than 9 hydrogens possible?  Should they be
supported?</em></span></p></div><div class="section" title="Charge"><div class="titlepage"><div><div><h4 class="title"><a id="charge"></a>Charge</h4></div></div></div><p>Charge is specified by a <code class="literal">+n</code> or <code class="literal">-n</code> where <code class="literal">n</code> is a number; if the
number is missing, it means either <code class="literal">+1</code> or <code class="literal">-1</code> as appropriate.</p><p>For backwards compatibility, a general-purpose SMILES parser should
accept the symbols <code class="literal">--</code> and <code class="literal">++</code> to mean charges of <code class="literal">-2</code> and <code class="literal">+2</code>, but this
is a deprecated form and should be avoided.</p><p>Examples:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="60%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comments</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Cl-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>chloride anion</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">-1</code> charge, <code class="literal">H0</code> implied</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[OH1-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>hydroxyl anion</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">-1</code> charge, <code class="literal">H1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[OH-1]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>hydroxyl anion</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">-1</code> charge, <code class="literal">H1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Cu+2]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>coppor cation</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">+2</code> charge, <code class="literal">H0</code> implied</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[Cu++]</code></p></td><td style="" align="left" valign="top"><p>copper anion</p></td><td style="" align="left" valign="top"><p><code class="literal">+2</code> charge, <code class="literal">H0</code> implied</p></td></tr></tbody></table></div><p>An implementation is required to accept charges in the range <code class="literal">-15</code> to <code class="literal">+15</code>.</p></div><div class="section" title="Isotopes"><div class="titlepage"><div><div><h4 class="title"><a id="_isotopes"></a>Isotopes</h4></div></div></div><p>Isotopic specification is placed inside the square brackets for an atom
preceeding the atomic symbol; for example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Atomic Symbol</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[13CH4]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[2H+]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>deuterium ion</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[238U]</code></p></td><td style="" align="left" valign="top"><p>Uranium 238 atom</p></td></tr></tbody></table></div><p>An isotope is interpreted as a number, so that <code class="literal">[2H]</code>,
<code class="literal">[02H]</code> and <code class="literal">[002H]</code> all mean deuterium.  If the isotope field
is not specified then the atom is assumed to have the naturally-occuring isotopic ratios.  The
isotope value 0 also indicates an isotope of zero, that is
<code class="literal">[0S]</code> is <span class="strong"><strong>not</strong></span> the same as <code class="literal">[S]</code>.</p><p>There is no requirement that the isotope is a genuine isotope of the element.  Thus,
<code class="literal">[36Cl]</code> is allowed even though <sup>35</sup>Cl and
<sup>37</sup>Cl are the actual known stable isotopes of chlorine.</p><p>A general-purpose SMILES parser must accept at least three digits for the isotope and values
from 0 to 999.</p></div><div class="section" title="Organic Subset"><div class="titlepage"><div><div><h4 class="title"><a id="orgsbst"></a>Organic Subset</h4></div></div></div><p>A special subset of elements called the "organic subset" of
<span class="strong"><strong>B</strong></span>, <span class="strong"><strong>C</strong></span>, <span class="strong"><strong>N</strong></span>, <span class="strong"><strong>O</strong></span>, <span class="strong"><strong>P</strong></span>, <span class="strong"><strong>S</strong></span>, <span class="strong"><strong>F</strong></span>,
<span class="strong"><strong>Cl</strong></span>, <span class="strong"><strong>Br</strong></span>, <span class="strong"><strong>I</strong></span>, and <span class="strong"><strong>*</strong></span> (the "wildcard" atom) can be
written using the only the atomic symbol (that is, without the square
brackets, H-count, etc.).  An atom is specified this way has the
following properties:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
"implicit hydrogens" are added such that valence of the atom is in
  the lowest normal state for that element
</li><li class="listitem">
the atom’s charge is zero
</li><li class="listitem">
the atom has no isotopic specification
</li><li class="listitem">
the atom has no chiral specification
</li></ul></div><p>The implicit hydrogen count is determined by summing the bond orders
of the bonds connected to the atom.  If that sum is equal to a known
valence for the element or is greater than any known valence then the
implicit hydrogen count is 0.  Otherwise the implicit hydrogen count is the
difference between that sum and the next highest known valence.</p><p>The "normal valence" for these elements is defined as:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="30%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Element       </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Valence</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>B</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>3</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>C</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>4</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>N</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>3 or 5</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>O</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>P</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>3 or 5</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>S</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2, 4 or 6</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>halogens</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td></tr><tr><td style="" align="left" valign="top"><p>*</p></td><td style="" align="left" valign="top"><p>unspecified</p></td></tr></tbody></table></div><p>Examples:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="30%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">N</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ammonia</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">Cl</code></p></td><td style="" align="left" valign="top"><p>hydrochloric acid</p></td></tr></tbody></table></div><p><span class="emphasis"><em>Note: The remaining atom properties, chirality and ring-closures, are discussed in later sections.</em></span></p></div><div class="section" title="The Wildcard '*' Atomic Symbol"><div class="titlepage"><div><div><h4 class="title"><a id="_the_wildcard_literal_literal_atomic_symbol"></a>The Wildcard <code class="literal">'*'</code> Atomic Symbol</h4></div></div></div><p>The <code class="literal">'*'</code> atom represents an atom whose atomic number is unknown or unspecified.  If it occurs
inside brackets, it can have its isotope, chirality, hydrogen count and charge specified.  If it
occurs outside of brackets, it has no assumed isotope, a mass of zero, unspecified chirality, a
hydrogen count of zero, and a charge of zero.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">Oc1c(*)cccc1</code></p></td><td style="" align="left" valign="top"><p>ortho-substituted phenol</p></td></tr></tbody></table></div><p>The <code class="literal">'*'</code> atom does not have any specific electronic properties or
valence.  If specified outside of square brackets, it takes on the valence
implied by its bonds.  If it is inside square brackets, it takes on the
valence implied by its bonds, hydrogens and/or charge.</p><p>A <code class="literal">'*'</code> atom can be part of an aromatic ring.  When deducing the
aromaticity of a ring system, the ring system is considered aromatic if
there is an element which could replace the <code class="literal">'*'</code> and make the ring system
meet the aromaticity rules (see <a class="link" href="#inaromaticity" title="3.5. Aromaticity">Aromaticity</a>, below).</p></div><div class="section" title="Atom Class"><div class="titlepage"><div><div><h4 class="title"><a id="atomclass"></a>Atom Class</h4></div></div></div><p>An "atom class" is an arbitrary integer, a number that has no chemical
meaning.  It is used by applications to mark atoms in ways that are
meaningful only to the application.  Multiple atoms may be labeled with the
same atom class.</p><p>The atom class is specified after all other properties in square brackets. For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">[CH4:2]</code></p></td><td style="" align="left" valign="top"><p>methane, atom’s class is 2</p></td></tr></tbody></table></div><p>If the atom class is not specified then the atom class is zero.
The atom class is interpreted as a number, so both <code class="literal">[CH2:5]</code>
and <code class="literal">[NH4+:005]</code> have an atom class of 5.</p></div></div><div class="section" title="3.2. Bonds"><div class="titlepage"><div><div><h3 class="title"><a id="bonds"></a>3.2. Bonds</h3></div></div></div><p>Atoms that are adjacent in a SMILES string are assumed to
be joined by a single or aromatic bond (see <a class="link" href="#inaromaticity" title="3.5. Aromaticity">Aromaticity</a>). For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="30%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">NCCCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>n-butylamine</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">CCCCN</code></p></td><td style="" align="left" valign="top"><p>n-butylamine</p></td></tr></tbody></table></div><p>Double, triple and quadruple bonds are represented by <code class="literal">'='</code>, <code class="literal">'#'</code>, and <code class="literal">'$'</code> respectively:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="80%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                                      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C=C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C#N</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>hydrogen cyanide</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC#CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2-butyne</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCC=O</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>propanol</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[Rh-](Cl)(Cl)(Cl)(Cl)$[Rh-](Cl)(Cl)(Cl)Cl</code></p></td><td style="" align="left" valign="top"><p>octachlorodirhenate (III)</p></td></tr></tbody></table></div><p>A single bond can be explicitely represented with <code class="literal">'-'</code>, but it is rarely
necessary.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> </th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C-C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>same as: <code class="literal">CC</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C-C-O</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>same as: <code class="literal">CCO</code></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C-C=C-C</code></p></td><td style="" align="left" valign="top"><p>same as: <code class="literal">CC=CC</code></p></td></tr></tbody></table></div><p>Note: The remaining bond symbols, <code class="literal">':\/'</code>, are discussed in
later sections.</p></div><div class="section" title="3.3. Branches"><div class="titlepage"><div><div><h3 class="title"><a id="_branches"></a>3.3. Branches</h3></div></div></div><p>An atom with three or more bonds is called a <span class="strong"><strong>branched atom</strong></span>, and is
represented using parentheses.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                 </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/2-ethyl-1-butanol.gif" alt="depict/2-ethyl-1-butanol.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">CCC(CC)CO</code></p></td><td style="" align="left" valign="top"><p>2-ethyl-1-butanol</p></td></tr></tbody></table></div><p>Branches can be nested or "stacked" to any depth:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                   </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/2-4-dimethyl-3-pentanone.gif" alt="depict/2-4-dimethyl-3-pentanone.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC(C)C(=O)C(C)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2,4-dimethyl-3-penthanone</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>pic here</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">OCC(CCC)C(C(C)C)CCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2-propyl-3-isopropyl-1-propanol</p></td></tr><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/thiosulfate.gif" alt="depict/thiosulfate.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">OS(=O)(=S)O</code></p></td><td style="" align="left" valign="top"><p>thiosulfate</p></td></tr></tbody></table></div><p>The SMILES branch/chain rules allow nested parenthetical expressions (branches) to an arbitrary
depth. For example, the following SMILES, though peculiar, is legal:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                                                              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Formula</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C(C))))))))))))))))))))C</code></p></td><td style="" align="left" valign="top"><p>C22H46</p></td></tr></tbody></table></div></div><div class="section" title="3.4. Rings"><div class="titlepage"><div><div><h3 class="title"><a id="ringclosure"></a>3.4. Rings</h3></div></div></div><p>In a SMILES string such as "C1CCCCC1", the first occurance of a ring-closure
number (an "rnum") creates an "open bond" to the atom that preceeds the
ring-closure number (the "rnum").  When that same rnum is encountered
later in the string, a bond is made between the two atoms, which typically
forms a cyclic structure.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                               </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES           </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cyclohexane.gif" alt="depict/cyclohexane.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1CCCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>cyclohexane</p></td></tr><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/perhydroisoquinoline.gif" alt="depict/perhydroisoquinoline.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">N1CC2CCCC2CC1</code></p></td><td style="" align="left" valign="top"><p>perhydroisoquinoline</p></td></tr></tbody></table></div><p>If a bond symbol is present between the atom and rnum, it can be
present on <span class="strong"><strong>either or both</strong></span> bonded atoms.  However, if it appears on
both bonded atoms, the two bond symbols must be the same.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" rowspan="4" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cyclohexane.gif" alt="depict/cyclohexane.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C=1CCCCC=1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>cyclohexene</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C=1CCCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>cyclohexene <span class="strong"><strong>(preferred from)</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1CCCCC=1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>cyclohexene</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C-1CCCCC=1</code></p></td><td style="" align="left" valign="top"><p><span class="strong"><strong>invalid</strong></span></p></td></tr></tbody></table></div><p>Ring closures must be matched pairs in a SMILES string, for example, <code class="literal">C1CCC</code>
is not a valid SMILES.</p><p>It is permissable to re-use ring-closure numbers.  Once a particular number
has been encountered twice, that number is available again for subsequent ring closures.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comment</th></tr></thead><tbody><tr><td style="" rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/dicyclohexyl.gif" alt="depict/dicyclohexyl.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1CCCCC1C1CCCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>dicyclohexyl</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>both SMILES are valid</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C1CCCCC1C2CCCCC2</code></p></td><td style="" align="left" valign="top"><p>dicyclohexyl</p></td><td style="" align="left" valign="top"><p></p></td></tr></tbody></table></div><p>Note that the ring number zero is valid, for example cyclohexane can be
written <code class="literal">C0CCCCC0</code>.</p><p>Two-digit ring numbers are permitted, but must be preceeded by the percent
<code class="literal">'%'</code> symbol, such as <code class="literal">C%25CCCCC%25</code> for cyclohexane. Three-digit numbers and
larger are never permitted.  However, note that three digits are not invalid; for
example, <code class="literal">C%123</code> is the same as <code class="literal">C3%12</code>, that is, an atom with two rnum
specifications.</p><p>The digit(s) representing a ring-closure are interpreted as a number, not a
symbol, and two rnums match if their numbers match.  Thus, <code class="literal">C1CCCCC%01</code> is a
valid SMILES and is the same as <code class="literal">C1CCCCC1</code>.  Likewise, <code class="literal">C%00CCCCC%00</code> is a
valid SMILES.</p><p>A single atom can have several ring-closure numbers, such as this spiro
atom:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/spiro.gif" alt="depict/spiro.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">C12(CCCCC1)CCCCC2</code></p></td><td style="" align="left" valign="top"><p>spiro[5.5]undecane</p></td></tr></tbody></table></div><p>Two atoms cannot be joined by more than one bond, and an atom cannot be bonded to itself. For
example, the following are not allowed:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="70%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comments</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C12CCCCC12</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="strong"><strong>illegal, two bonds between one pair of atoms</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C12C2CCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="strong"><strong>illegal, two bonds between one pair of atoms</strong></span></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C11</code></p></td><td style="" align="left" valign="top"><p><span class="strong"><strong>illegal, atom bonded to itself</strong></span></p></td></tr></tbody></table></div></div><div class="section" title="3.5. Aromaticity"><div class="titlepage"><div><div><h3 class="title"><a id="inaromaticity"></a>3.5. Aromaticity</h3></div></div></div><div class="section" title="The Meaning of &quot;Aromaticity&quot; in SMILES"><div class="titlepage"><div><div><h4 class="title"><a id="_the_meaning_of_aromaticity_in_smiles"></a>The Meaning of "Aromaticity" in SMILES</h4></div></div></div><p>"Aromaticity" in SMILES is primarily for
<a class="ulink" href="http://www.emolecules.com/doc/cheminformatics-101.htm" target="_top">cheminformatics</a> purposes.
In a cheminformatics system, we’d like to have a single representation for each molecule.  The
Kekule form masks the inherent uniformity of the bonds in an aromatic ring.  SMILES uses a
simplified definition of aromaticity that facilitates substructure and exact-structure
searches, as well as <a class="link" href="#normalization" title="4. Writing SMILES: Normalizations">Normalization</a> and <a class="link" href="#canonicalization" title="4.4. Canonical SMILES">Canonicalization</a> of SMILES.</p><p>The definition of "aromaticity" in SMILES is <span class="strong"><strong>not</strong></span> intended to imply anything about the
physical or chemical properties of a substance.  In many or most cases, the SMILES definition of
aromaticity will match the chemist’s notion of what is aromatic, but in some cases it will not.</p></div><div class="section" title="Kekule and Aromatic Representations"><div class="titlepage"><div><div><h4 class="title"><a id="_kekule_and_aromatic_representations"></a>Kekule and Aromatic Representations</h4></div></div></div><p>Aromaticity can be represented in one of two ways in a SMILES.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
In the Kekule form, using alternating single and double bonds, with
  uppercase symbols for the atoms.
</li><li class="listitem">
An atomic symbol that begins with a lowercase letter is an aromatic atom, such as <code class="literal">'c'</code>
  for aromatic carbon.  When aromatic symbols are used, no bond symbols are needed.
</li></ul></div><p>A lowercase aromatic symbol is defined as an atom in the sp<sup>2</sup> configuration in an
aromatic or anti-aromatic ring system.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                 </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/benzene.gif" alt="depict/benzene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>benzene</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1=CC=CC=C1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/indane.gif" alt="depict/indane.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccc2CCCc2c1</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>indane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1=CC=CC(CCC2)=C12</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/furan.gif" alt="depict/furan.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1occc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>furan</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1O=CC=C1</code></p></td></tr><tr><td style="" rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cyclobutadiene.gif" alt="depict/cyclobutadiene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccc1</code></p></td><td style="" rowspan="2" align="left" valign="top"><p>cyclobutadiene</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C1=CC=C1</code></p></td></tr></tbody></table></div><p>The Kekule form is always acceptable for SMILES input.  For output, the aromatic form
(using lowercase letters) <a class="link" href="#outaromaticity" title="Aromaticity">is preferred</a>.  The lowercase
symbols eliminate the arbitrary choice of how to assign the single and double bonds, and provide a
<a class="link" href="#normalization" title="4. Writing SMILES: Normalizations">normalized form</a> that more accurately reflects the electronic configuration.</p></div><div class="section" title="Extended Hueckel’s Rule"><div class="titlepage"><div><div><h4 class="title"><a id="_extended_hueckel_8217_s_rule"></a>Extended Hueckel’s Rule</h4></div></div></div><p><span class="strong"><strong><span class="red">THIS SECTION IS UNDER MAJOR REVISION, AND AT THIS POINT IS ONLY FOR
DISCUSSION PURPOSES.</span></strong></span></p><p><span class="strong"><strong><span class="red">This proposed section is an attempt to simplify the rule-based
system by enumerating all atom/bond configurations that are known to
participate in aromatic systems.</span></strong></span></p><p>A single, isolated ring that meets the following criteria is aromatic:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
All atoms must be sp<sup>2</sup> hybridized.
</li><li class="listitem">
The number of availabile "shared" <a class="ulink" href="http://en.wikipedia.org/wiki/Pi_electron" target="_top">π electrons</a>
  must equal 4N+2 where N = 1, 2 or 3 (<a class="ulink" href="http://en.wikipedia.org/wiki/H%C3%BCckel’s_rule" target="_top">Huckel’s rule</a>).
</li></ul></div><p>Each element that can participate in an aromatic ring is defined to have the following
number of π electrons:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="50%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Configuration                     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> π Electrons </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Example</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-c-1.gif" alt="depict/sp2/sp2-c-1.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-c-2.gif" alt="depict/sp2/sp2-c-2.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-c-3.gif" alt="depict/sp2/sp2-c-3.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-c-4.gif" alt="depict/sp2/sp2-c-4.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-c-5.gif" alt="depict/sp2/sp2-c-5.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-cO-1.gif" alt="depict/sp2/sp2-cO-1.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>0-1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-cO-2.gif" alt="depict/sp2/sp2-cO-2.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>0</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-cO-3.gif" alt="depict/sp2/sp2-cO-3.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-1.gif" alt="depict/sp2/sp2-n-1.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-2.gif" alt="depict/sp2/sp2-n-2.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-3.gif" alt="depict/sp2/sp2-n-3.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-4.gif" alt="depict/sp2/sp2-n-4.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-5.gif" alt="depict/sp2/sp2-n-5.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-6.gif" alt="depict/sp2/sp2-n-6.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1-2</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-n-7.gif" alt="depict/sp2/sp2-n-7.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-o.gif" alt="depict/sp2/sp2-o.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-se.gif" alt="depict/sp2/sp2-se.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sp2/sp2-s.gif" alt="depict/sp2/sp2-s.gif" /></span></p></td><td style="" align="left" valign="top"><p>2</p></td><td style="" align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td></tr></tbody></table></div></div><div class="section" title="Aromaticity Algorithm"><div class="titlepage"><div><div><h4 class="title"><a id="_aromaticity_algorithm"></a>Aromaticity Algorithm</h4></div></div></div><p>In an aromatic system, all of the aromatic atoms must be sp:sup:<code class="literal">2</code> hybridized, and the
number of <a class="ulink" href="http://en.wikipedia.org/wiki/Pi_electron" target="_top">π electrons</a>
must meet <a class="ulink" href="http://en.wikipedia.org/wiki/H%C3%BCckel’s_rule" target="_top">Huckel’s 4n+2 criterion</a>
When parsing a SMILES, a parser must note the aromatic designation of each atom on
input, then when the parsing is complete, the SMILES software must verify that electrons can be
assigned without violating the valence rules, consistent with the sp<sup>2</sup> markings, the
specified or implied hydrogens, external bonds, and charges on the atoms.</p><p>The aromatic-bond symbol <code class="literal">':'</code> can be used between aromatic atoms, but it is never necessary; a
bond between two aromatic atoms is assumed to be aromatic unless it is explicitely represented as a
single bond <code class="literal">'-'</code>.  However, a single bond (nonaromatic bond) between two aromatic atoms <span class="strong"><strong>must</strong></span>
be explicitely represented.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                   </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                 </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/biphenyl.gif" alt="depict/biphenyl.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">c1ccccc1-c2ccccc2</code></p></td><td style="" align="left" valign="top"><p>biphenyl</p></td></tr></tbody></table></div><p><span class="emphasis"><em>Note: Some SMILES parsers interpret a lowercase letter as sp<sup>2</sup> anywhere it appears;
for example, <code class="literal">CccccC</code> would be interpreted as <code class="literal">CC=CC=CC</code>.
The OpenSMILES specification does not allow this interpretation unless
<a class="link" href="#nonstandard" title="5. Nonstandard Forms of SMILES">nonstandard parsing</a> is explicitely allowed by the user.</em></span></p></div></div><div class="section" title="3.6. More about Hydrogen"><div class="titlepage"><div><div><h3 class="title"><a id="_more_about_hydrogen"></a>3.6. More about Hydrogen</h3></div></div></div><p>Hydrogens in a SMILES can be represented in three different ways:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Method                </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comments</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>implicit hydrogen</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>h-count deduced from normal valence (4)</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>atom property</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH4]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>h-count specified for heavy atom</p></td></tr><tr><td style="" align="left" valign="top"><p>explicit hydrogen</p></td><td style="" align="left" valign="top"><p><code class="literal">[H]C([H])([H])[H]</code></p></td><td style="" align="left" valign="top"><p>methane</p></td><td style="" align="left" valign="top"><p>hydrogens represented as normal atoms</p></td></tr></tbody></table></div><p>All three forms are equivalent.  However, some situations require that one form must be used:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Implicit hydrogen count may only be used for elements of the <a class="link" href="#orgsbst" title="Organic Subset">organic elements</a> subset.
</li><li class="listitem">
Any atom that is specified with square brackets <span class="strong"><strong>must</strong></span> have its attached hydrogens
  explicitely represented, either as a hydrogen count or as normal atoms.
</li></ul></div><p>A hydrogen that meets one of the following criteria must be represented as an explicit atom:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
hydrogens with charge (<code class="literal">[H+]</code>)
</li><li class="listitem">
a hydrogen connected to another hydrogen (such as molecular hydrogen, <code class="literal">[H][H]</code>)
</li><li class="listitem">
hydrogens with more than one bond (bridging hydrogens)
</li><li class="listitem">
Deuterium <code class="literal">[2H]</code> and tritium <code class="literal">[3H]</code>
</li></ul></div><p>It is permissible to use a mixture of an atom h-count and explicit hydrogen.  In such a case,
the atom’s hydrogen count is the sum of the atomic h-count property and the number of attached
hydrogens.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH4]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[H][CH2][H]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>methane</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[2H][CH2]C</code></p></td><td style="" align="left" valign="top"><p>deuteroethane</p></td></tr></tbody></table></div></div><div class="section" title="3.7. Disconnected Structures"><div class="titlepage"><div><div><h3 class="title"><a id="_disconnected_structures"></a>3.7. Disconnected Structures</h3></div></div></div><p>The dot <code class="literal">'.'</code> symbol (also called a "dot bond") is legal most places where
a bond symbol would occur, but indicates that the atoms are <span class="strong"><strong>not</strong></span>
bonded.  The most common use of the dot-bond symbol is to represent
disconnected and ionic compounds.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                            </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/sodium-chloride.gif" alt="depict/sodium-chloride.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Na+].[Cl-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>sodium chloride</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/phenol-2-amino-ethanol.gif" alt="depict/phenol-2-amino-ethanol.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">Oc1ccccc1.NCCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>phenol, 2-amino ethanol</p></td></tr><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/diammonium-thiosulfate.gif" alt="depict/diammonium-thiosulfate.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">[NH4+].[NH4+].[O-]S(=O)(=O)[S-]</code></p></td><td style="" align="left" valign="top"><p>diammonium thiosulfate</p></td></tr></tbody></table></div><p>The dot can appear most places that a bond symbol is allowed, for example, the phenol example above
can also be written:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/phenol-2-amino-ethanol.gif" alt="depict/phenol-2-amino-ethanol.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1cc(O.NCCO)ccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>phenol, 2-amino ethanol</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">Oc1cc(.NCCO)ccc1</code></p></td><td style="" align="left" valign="top"><p>phenal, 2-amino ethanol</p></td></tr></tbody></table></div><p>The second example above is an odd, but legal, use of parentheses and the dot bond, since the
syntax allows a dot most places a regular bond could appear (the exception
is that a dot can’t appear before a ring-closure digit).</p><p>Although dot-bonds are commonly used to represent compounds with disconnected parts, a dot-bond
does <span class="strong"><strong>not</strong></span> in itself mean that there are disconnected parts in the compound.   See the
following section regarding ring digits for some examples that illustrate this.</p><p>The dot bond cannot be used in front of a ring-closure digit.  For example, <code class="literal">C.1CCCCC.1</code> is illegal.</p><div class="section" title="Other Uses of Ring Numbers and Dot Bond"><div class="titlepage"><div><div><h4 class="title"><a id="_other_uses_of_ring_numbers_and_dot_bond"></a>Other Uses of Ring Numbers and Dot Bond</h4></div></div></div><p>A ring-number specifications ("rnum") is most commonly used to specify a ring-closure bond, but
when used with the <code class="literal">'.'</code> dot-bond symbol, it can also specify a non-ring bond.  Two rnums in a SMILES
mean that the two atoms that preceed the rnums are bonded.  A dot-bond <code class="literal">'.'</code> means that the atoms to
which it is adjacent in the SMILES string are <span class="strong"><strong>not</strong></span> bonded to each other.  By combining these
two constructs, one can "piece together" fragments of SMILES into a whole molecule.  The following
SMILES illustrate this:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES/Depiction                               </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Fragment SMILES           </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1.C1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1.C12.C2</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>propane</p></td></tr><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/1-bromo-2-3-dichlorobenzene.gif" alt="depict/1-bromo-2-3-dichlorobenzene.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">c1c2c3c4cc1.Br2.Cl3.Cl4</code></p></td><td style="" align="left" valign="top"><p>1-bromo-2,3-dichlorobenzene</p></td></tr></tbody></table></div><p>This feature of SMILES provides a convenient method of enumerating the
molecules of a combinatorial library using string concatenation.</p></div></div><div class="section" title="3.8. Stereochemistry"><div class="titlepage"><div><div><h3 class="title"><a id="chirality"></a>3.8. Stereochemistry</h3></div></div></div><div class="section" title="Scope of Stereochemistry in SMILES"><div class="titlepage"><div><div><h4 class="title"><a id="_scope_of_stereochemistry_in_smiles"></a>Scope of Stereochemistry in SMILES</h4></div></div></div><p>A SMILES string can specify the cis/trans configuration around a double bond,
and can specify the chiral configuration of specific atoms in a molecule.</p><p>SMILES strings do <span class="strong"><strong>not</strong></span> represent all types of stereochemistry.  Examples of
stereochemistry that cannot be encoded into a SMILES include:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Gross conformational left or right handedness such as helicenes
</li><li class="listitem">
Mechanical interferences, such as rotatable bonds that are
  constrained by mechanical interferences
</li><li class="listitem">
Gross conformational stereochemistry such as the shape of a protein after folding
</li></ul></div></div><div class="section" title="Tetrahedral Centers"><div class="titlepage"><div><div><h4 class="title"><a id="_tetrahedral_centers"></a>Tetrahedral Centers</h4></div></div></div><p>SMILES uses an atom-centered chirality specification, in which the atom’s left-to-right order in
the SMILES string itself is used as the basis for the chirality marking.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " colspan="2" align="left" valign="top"> <span class="strong"><strong>Tetrahedral Chirality</strong></span></th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>look from N towards C (chiral center)</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>list the neighbors anticlockwise</p></td></tr><tr><td style="" rowspan="3" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/tetrahedral.gif" alt="depict/tetrahedral.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">N[C@](Br)(O)C</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>…or clockwise</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">N[C@@](Br)(C)O</code></p></td></tr></tbody></table></div><p>For the structure above, starting with the nitrogen atom, one "looks" toward the chiral
center. The the remaining three neighbor atoms are written by listing them in anticlockwise order using the <code class="literal">'@'</code>
chiral property on the atom, or in clockwise order using the <code class="literal">'@@'</code> chiral property, as illustrated
above.  The <code class="literal">'@'</code> symbol is a "visual mnemonic" in that the spiral around the character goes in the
anticlockwise direction, and means "anticlockwise" in the SMILES string (thus, <code class="literal">'@@'</code> can be thought of
as anti-anti-clockwise).</p><p>A chiral center can be written starting from any of its neighbor atoms, and the choice of
whether to list the remaining neighbor in clockwise or anticlockwise order is also arbitrary.  The
following SMILES are all equivalent and all specify the exact same chiral center illustrated above:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="50%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Equivalent SMILES  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> </th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">N[C@](Br)(O)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">Br[C@](O)(N)C</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">O[C@](Br)(C)N</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">Br[C@](C)(O)N</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C[C@](Br)(N)O</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">Br[C@](N)(C)O</code></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C[C@@](Br)(O)N</code></p></td><td style="" align="left" valign="top"><p><code class="literal">Br[C@@](N)(O)C</code></p></td></tr></tbody></table></div><p>If one of the neighbor atoms is a hydrogen and is represented as an atomic property of the
chiral center (rather than explicitely as <code class="literal">[H]</code>), then it is considered to be the first atom in the
clockwise or anticlockwise accounting.  For example, if we replaced the bromine in the illustration
above with a hydrogen atom, its SMILES would be:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="25%"><colgroup><col class="col_1" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Implicit Hydrogen</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">N[C@H](O)C</code></p></td></tr></tbody></table></div></div><div class="section" title="Cis/Trans configuration of Double Bonds"><div class="titlepage"><div><div><h4 class="title"><a id="_cis_trans_configuration_of_double_bonds"></a>Cis/Trans configuration of Double Bonds</h4></div></div></div><p>The configuration of atoms around double bonds is specified by the bond symbols <code class="literal">'/'</code> and <code class="literal">'\'</code>.
These symbols always come in pairs, and indicate cis or trans with a visual "same side" or
"opposite side" concept.  That is:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                     </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES            </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/trans-difluoroethene.gif" alt="depict/trans-difluoroethene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F/C=C/F</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>trans-difluoroethane <span class="strong"><strong>(both SMILES are equivalent)</strong></span></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F\C=C\F</code></p></td></tr><tr><td style="" rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cis-difluoroethene.gif" alt="depict/cis-difluoroethene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F\C=C/F</code></p></td><td style="" rowspan="2" align="left" valign="top"><p>cis-difluoroethane <span class="strong"><strong>(both SMILES are equivalent)</strong></span></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">F/C=C\F</code></p></td></tr></tbody></table></div><p>The "visual interpretation" of the <code class="literal">'/'</code> and <code class="literal">'\'</code> symbol is that they are thought of as bonds that
"point" above or below the allenal carbon.  That is, <code class="literal">F/C=C/Br</code> means "The <code class="literal">F</code> is below the first carbon,
and the <code class="literal">Br</code> is above the second carbon," leading to the interpretation of a trans configuration.</p><p>This notation can be confusing when parentheses follow one of the allenal carbons:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F/C=C/F</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>trans-difluoroethane</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C(\F)=C/F</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F\C=C/F</code></p></td><td style="" rowspan="2" align="left" valign="top"><p>cis-difluoroethane</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C(/F)=C/F</code></p></td></tr></tbody></table></div><p>The "visual interpretation" of the "up-ness" or "down-ness" of each single
bond is <span class="strong"><strong>relative to the carbon atom</strong></span>, not the double bond, so the sense of the symbol changes
when the fluorine atom moved from the left to the right side of the allenal carbon atom.</p><p><span class="emphasis"><em>Note: This point was not well documented in earlier SMILES specifications, and several SMILES
interpreters are known to interpret the <code class="literal">'/'</code> and <code class="literal">'\'</code> symbols incorrectly.</em></span></p><p>A SMILES with conflicting up/down specifications is invalid:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="70%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES        </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comment</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">C/C(\F)=C/F</code></p></td><td style="" align="left" valign="top"><p>Invalid SMILES: Both the methyl and fluorine are "down" relative to the first allenal carbon</p></td></tr></tbody></table></div><p>It is permissible, but not required, that every atom attached to a double bond be marked.  As
long as at least two neighbor atoms, one on each end of the double bond, is marked, the "up-ness" or
"down-ness" of the unmarked neighbors can be deduced.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="75%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES        </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comment</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">F/C(CC)=C/F</code></p></td><td style="" align="left" valign="top"><p>trans-difluoro configuration, position of methyl is implied</p></td></tr></tbody></table></div><p>Extended cis and trans configurations can be specified for conjugated allenes with an odd number
of double bonds:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="50%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES             </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F/C=C=C=C/F</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>trans-difluorobutatriene</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">F/C=C=C=C\F</code></p></td><td style="" align="left" valign="top"><p>cis-difluorobutatriene</p></td></tr></tbody></table></div></div><div class="section" title="Tetrahedral Allene-like Systems"><div class="titlepage"><div><div><h4 class="title"><a id="_tetrahedral_allene_like_systems"></a>Tetrahedral Allene-like Systems</h4></div></div></div><p>Extended tetrahedral configurations can be specified for conjugated allenes with an even number
of double bonds.  The normal tetrahedral rules using <code class="literal">'@'</code> and <code class="literal">'@@'</code> apply, but the "neighbor" atoms
to which the chirality refers are at the ends of the allenal system.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="70%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                             </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/tetrahedral-allene.gif" alt="depict/tetrahedral-allene.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">NC(Br)=[C@]=C(O)C</code></p></td></tr></tbody></table></div><p>To determine the correct clockwise or anticlockwise specification, the allene is conceptually
"collapsed" into a single tetrahedral chiral center, and the resulting chirality is marked as a
property of the center atom of the extended allene system.</p></div><div class="section" title="Partial Stereochemistry"><div class="titlepage"><div><div><h4 class="title"><a id="_partial_stereochemistry"></a>Partial Stereochemistry</h4></div></div></div><p>SMILES allows partial stereochemical specifications.  It is permissible for some chiral centers
or double bonds to have stereochemical markings in the SMILES, while others in the same SMILES
string do not.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="60%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comment</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F/C=C/C/C=C\\C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>completely specified</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F/C=C/CC=CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>partially specified</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">N1[C@H](Cl)[C@@H](Cl)C(Cl)CC1</code></p></td><td style="" align="left" valign="top"><p>partially specified</p></td></tr></tbody></table></div></div><div class="section" title="Other Chiral Configurations"><div class="titlepage"><div><div><h4 class="title"><a id="_other_chiral_configurations"></a>Other Chiral Configurations</h4></div></div></div><p>The SMILES language supports a number of atom-centered chiral
configurations:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMARTS </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Configuration</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">TH</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Tetrahedral</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">AL</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Allenal</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">SP</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Square Planar</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">TB</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Trigonal Bipyramidal</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">OH</code></p></td><td style="" align="left" valign="top"><p>Octahedral</p></td></tr></tbody></table></div><p>The shorthand notations <code class="literal">'@'</code> and <code class="literal">'@@'</code> correspond to anti-clockwise and
clockwise tetrahedral chirality, and are the same a <code class="literal">'@TH1'</code> and
<code class="literal">'@TH2'</code>, respectively.  Likewise, in an allenal configuration, the shorthand
notations <code class="literal">'@'</code> and <code class="literal">'@@'</code> correspond to <code class="literal">'@AL1'</code> and <code class="literal">'@AL2'</code>, respectively.</p><p>Very few SMILES systems actually implement the rules for <code class="literal">SP</code>, <code class="literal">TB</code> or <code class="literal">OH</code> chirality.</p><p><span class="strong"><strong>NEED COMPLETE DOCUMENTATION for SP, TB and OH.</strong></span></p></div></div><div class="section" title="3.9. Parsing Termination"><div class="titlepage"><div><div><h3 class="title"><a id="_parsing_termination"></a>3.9. Parsing Termination</h3></div></div></div><p>A SMILES string is terminated by a whitespace terminator character (space, tab, newline,
carriage-return), or by the end of the string.</p><p>Other data or information, such as a name, properties, registration number, etc., may follow the
SMILES on a line after the whitespace character.  SMILES parsers will ignore this data, although
applications that use the SMILES parser will often make use of it.</p></div><div class="section" title="3.10. Programming Practices"><div class="titlepage"><div><div><h3 class="title"><a id="_programming_practices"></a>3.10. Programming Practices</h3></div></div></div><p>OpenSMILES is designed to facilitate exchange of chemical information.  To achieve that goal, it
SMILES parsers should impose as few limits as possible on the language.</p><p>There is no formal limit to the length of a SMILES string; SMILES of over 1 million characters
have been assembled for various purposes.  There is no requirement that a SMILES parser must be able
to parse these exceptionally long SMILES, but as a guideline, all implementations of SMILES parsers
should, at a minimum, accept and correctly parse SMILES strings of 100,000 characters.  If a SMILES
parser encounters a string that is too long to parse, it should generate a relevant error
message.</p><p>A SMILES parser should accept at least four digits for the <a class="link" href="#atomclass" title="Atom Class">atom class</a>,
and the values 0 to 9999.</p><p>There is no formal limit to the number of rings a molecule can contain.  There are only
100 ring-closure numbers, but since numbers can be reused, a molecule can potentially have more
than 100 rings.  SMILES parsers should accept and correctly parse molecules with at least 1000 rings;
it is preferable to place no limits on the number of rings a molecule can contain.</p><p>Branches (parentheses) can be nested to an arbitrary depth.  Some SMILES strings in standard
databases contain over 30 levels of branches, and much deeper nesting is possible.  A general
purpose parser must handle at least 100 levels; it is preferrable to place no limits on nesting
depth for parentheses.</p><p>There is no formal limit on the number of bonds an atom can have.  SMILES parsers should allow at
least ten bonds to each atom; it is preferrable to place no limits on the number of bonds to each
atom.</p><p>There is no limit to the number of "dot-disconnected" fragments in a SMILES.  A SMILES of 100,000
atoms could in principle contain no bonds at all; SMILES parsers should place no limits on the
number of fragments allowed (except that it is limited to the number of atoms the parser can
manage).</p><p>Programmers are <span class="strong"><strong>strongly</strong></span> encouraged to provide detailed and clear error messages.  If
possible, the error message should show exactly which character or "phrase" of the SMILES string
triggered the error message.</p></div></div><div class="section" title="4. Writing SMILES: Normalizations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="normalization"></a>4. Writing SMILES: Normalizations</h2></div></div></div><div class="section" title="4.1. What is Normalization?"><div class="titlepage"><div><div><h3 class="title"><a id="_what_is_normalization"></a>4.1. What is Normalization?</h3></div></div></div><p>A wide variety of SMILES strings are acceptable as input.  For example, all of the following
represent ethanol:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="60%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">OCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C(O)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH3][CH2][OH]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[H][C]([H])([H])C([H])([H])[O][H]</code></p></td><td style="" align="left" valign="top"><p>ethanol</p></td></tr></tbody></table></div><p>However, it is desirable to write SMILES in more standard forms; the first two forms above are
preferred by most chemists, and require fewer bytes to store on a computer. Several levels of
normalization of SMILES are recommended for systems that generate SMILES strings.  Although these are not
mandatory in any sense, they should be considered guidelines for software engineers creating SMILES systems.</p></div><div class="section" title="4.2. No Normalization"><div class="titlepage"><div><div><h3 class="title"><a id="_no_normalization"></a>4.2. No Normalization</h3></div></div></div><p>The simplest "normalization" is no normalization.  SMILES can be written in any form whatsoever,
as long as they meet the rules for SMILES.  Some examples of systems that might produce
un-normalized SMILES are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
A system that enumerates combinatorial libraries using the rnum/dot-bond technique
  <a class="link" href="#inatoms" title="3.1. Atoms">discussed above</a>.  SMILES produced by such a system will typically be a series
  of partial SMILES that are concatenated with dots into a complete molecule.
</li><li class="listitem">
Simple pass-through "filters" that don’t have a full SMILES writer, but merely copy the input
  SMILES to the output.  An example might be a molecular modeling program that reads SMILES to
  generates logP values, but has no capability to convert its molecular data structures back to a
  SMILES; instead it just copies its input SMILES to its output.
</li></ul></div></div><div class="section" title="4.3. Standard Form"><div class="titlepage"><div><div><h3 class="title"><a id="standardform"></a>4.3. Standard Form</h3></div></div></div><p>The "standard form" of a SMILES is designed to produce a compact SMILES,
and one that is human readable (for smaller molecules).</p><p>In addition, a normalized SMILES has the important property that it
matches itself as a
<a class="ulink" href="http://www.daylight.com/dayhtml/doc/theory/theory.smarts.html" target="_top">SMARTS</a>
string.  This is a very important feature of normalized SMILES in
cheminformatics systems.</p><p><span class="emphasis"><em>Note: In the example below, the "Wrong" SMILES examples are all valid SMILES, but are "wrong"
in the sense that they are not the preferred form for standard normalization.</em></span></p><div class="section" title="Atoms"><div class="titlepage"><div><div><h4 class="title"><a id="_atoms"></a>Atoms</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct        </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong             </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH3][CH3]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Write atoms in the "organic subset" as bare atomic symbols whenever possible.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH3-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH3-1]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>If the charge is <code class="literal">+1</code> or <code class="literal">-1</code>, leave off the digit.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C[13CH](C)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C[13CH1](C)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>If the hydrogen count is 1, leave off the digit.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[CH3-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[C-H3]</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>Always write the atom properties in the order: Chirality, hydrogen-count, charge.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C[C@H](Br)Cl</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C[CH@](Br)Cl</code></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">[CH3-]</code></p></td><td style="" align="left" valign="top"><p><code class="literal">[H][C-]([H])[H]</code></p></td><td style="" align="left" valign="top"><p>Represent hydrogens as a property of the heavy atom rather than as explicit atoms, unless other rules (e.g. <code class="literal">[2H]</code>) require that the hydrogen be explicit.</p></td></tr></tbody></table></div></div><div class="section" title="Bonds"><div class="titlepage"><div><div><h4 class="title"><a id="_bonds"></a>Bonds</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct             </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C-C</code></p></td><td style="" rowspan="3" align="left" valign="top"><p>Only write <code class="literal">'-'</code> (single bond) when it is between two aromatic atoms.  Never write the <code class="literal">':'</code> (aromatic bond) symbol.  Bonds are single or aromatic by default (as appropriate).</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c:1:c:c:c:c:c:1</code></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">c1ccccc1-c2ccccc2</code></p></td><td style="" align="left" valign="top"><p><code class="literal">c1ccccc1c2ccccc2</code></p></td></tr></tbody></table></div></div><div class="section" title="Cycles"><div class="titlepage"><div><div><h4 class="title"><a id="_cycles"></a>Cycles</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct           </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong               </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1C2CCCC2</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1C1CCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Don’t reuse ring-closure digits.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1C2CCCC2</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c0ccccc0C1CCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Begin ring numbering with 1, not zero (or any other number)</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC1=CCCCC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC=1CCCCC=1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Avoid making a ring-closure on a double or triple bond.  For the ring-closure digits, choose a single bond whenever possible.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1CC2CCCCC2CC1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C12(CCCCC1)CCCCC2</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Avoid starting a ring system on an atom that is in two or more rings, such that two ring-closure bonds will be on the same atom.</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">C1CCCCC1</code></p></td><td style="" align="left" valign="top"><p><code class="literal">C%01CCCCC%01</code></p></td><td style="" align="left" valign="top"><p>Use the simpler single-digit form for rnums less than 10.</p></td></tr></tbody></table></div></div><div class="section" title="Starting Atom and Branches"><div class="titlepage"><div><div><h4 class="title"><a id="_starting_atom_and_branches"></a>Starting Atom and Branches</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct       </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">OCc1ccccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1cc(CO)ccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Start on a terminal atom if possible.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC(C)CCCCCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC(CCCCCC)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Try to make "side chains" short; pick the longest chains as the "main branch" of the SMILES.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">OCCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Start on a heteroatom if possible.</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">CC</code></p></td><td style="" align="left" valign="top"><p><code class="literal">C1.C1</code></p></td><td style="" align="left" valign="top"><p>Only use dots for disconnected components.</p></td></tr></tbody></table></div></div><div class="section" title="Aromaticity"><div class="titlepage"><div><div><h4 class="title"><a id="outaromaticity"></a>Aromaticity</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong         </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><code class="literal">c1ccccc1</code></p></td><td style="" align="left" valign="top"><p><code class="literal">C1=CC=CC=C1</code></p></td><td style="" align="left" valign="top"><p>Write the aromatic form in preference to the Kekule form.</p></td></tr></tbody></table></div></div><div class="section" title="Chirality"><div class="titlepage"><div><div><h4 class="title"><a id="_chirality"></a>Chirality</h4></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Correct    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Wrong          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Normalization Rule</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">BrC(Br)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">Br[C@H](Br)C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Remove chiral markings for atoms that are not chiral.</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">FC(F)=CF</code></p></td><td style="" align="left" valign="top"><p><code class="literal">F/C(/F)=C/F</code></p></td><td style="" align="left" valign="top"><p>Remove cis/trans markings for double bonds that are not cis or trans.</p></td></tr></tbody></table></div></div></div><div class="section" title="4.4. Canonical SMILES"><div class="titlepage"><div><div><h3 class="title"><a id="canonicalization"></a>4.4. Canonical SMILES</h3></div></div></div><p>A <span class="emphasis"><em>Canonical SMILES</em></span> is one that follows the <a class="link" href="#standardform" title="4.3. Standard Form">Standard Form</a>
above, and additionally, always writes the atoms and bonds of any particular molecule in
the <span class="emphasis"><em>exact same order</em></span>, regardless of the source of the molecule or its history in the
computer.  Here are a few examples of Canonical versus non-Canonical SMILES:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="50%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Canonical SMILES </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Non-canonical  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><code class="literal">OCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>ethanol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C(C)O</code></p></td></tr><tr><td style="" rowspan="3" align="left" valign="top"><p><code class="literal">Oc1ccccc1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1O</code></p></td><td style="" rowspan="3" align="left" valign="top"><p>phenol</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1(O)ccccc1</code></p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">c1(ccccc1)O</code></p></td></tr></tbody></table></div><p>The primary use of Canonical SMILES is in
<a class="ulink" href="http://www.emolecules.com/doc/cheminformatics-101.htm" target="_top">cheminformatics</a>
systems.  A molecule’s structure, when expressed as a canonical SMILES,
will always yield the same SMILES string, which allows a chemical database
system to:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Create a unique name (the SMILES) for each molecule in the system
</li><li class="listitem">
Consolidate data about one molecule from a variety of sources into a single record
</li><li class="listitem">
Given a molecule, find its record in the database
</li></ul></div><p>Canonical SMILES should <span class="emphasis"><em>not</em></span> be considered a universal, global
identifier (such as a permanent name that spans the WWW).  Two
systems that produces a canonical SMILES may use different rules in their
code, or the same system may be improved or have bugs fixed as time passes,
thus changing the SMILES it produces.  A Canonical SMILES is primarily
useful in a single database, or a system of related databases or information,
in which all molecules were created using a single canonicalizer.</p><p>The rules (algorithms) by which the canonical ordering of the atoms in a
SMILES are generated are quite complex, and beyond the scope of this
document.  There are many chemistry and mathematical graph-theory
papers describing the canonical labeling of a graph, and writing a
canonical SMILES string.  See the <a class="link" href="#appendix" title="7. APPENDIX 1: References and Citations">Appendix</a> for further
information.</p><p>Those considering Canonical SMILES for a database system should also investigate
<a class="ulink" href="http://www.iupac.org/inchi" target="_top">InChI</a>, a canonical naming system for chemicals that is an
approved IUPAC naming convention.</p></div><div class="section" title="4.5. SMILES Files"><div class="titlepage"><div><div><h3 class="title"><a id="_smiles_files"></a>4.5. SMILES Files</h3></div></div></div><p><span class="emphasis"><em>SMILES file</em></span> consists of zero or more SMILES strings, one per line, optionally followed
by at least one whitespace character (space or tab), and other data.  There can be no leading
whitespace before the SMILES string on a line.  The optional whitespace character and data that
follows it are not part of the SMILES specification, and interpretation of this data is up to
applications that use the SMILES file.  Each line of the file is terminated by either a singe LF
character, or by a CR/LF pair of characters (commonly called the "Unix" and "Windows" line
terminators, respectively).  A SMILES parser must accept either line terminator.  A blank line in
the SMILES file, or a line that begins with a whitespace character, should be completely ignored by
a SMILES parser.</p></div></div><div class="section" title="5. Nonstandard Forms of SMILES"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="nonstandard"></a>5. Nonstandard Forms of SMILES</h2></div></div></div><p>Several SMILES-generating systems are in use that either generate
incorrect SMILES, or that interpreted some of the ambiguous features of the
original SMILES specification in different ways.  Although these SMILES are
illegal according to this formal OpenSMILES specification, it is often useful to
parse them, in order to make use of the information that accompanies these
SMILES.</p><p>hese "relaxed" SMILES rules should only be allowed when the user
(presumably after thinking about the consequences) requests it.  A SMILES
parser that allows any or all of these "relaxed" rules <span class="emphasis"><em>must
not do it by default</em></span>.  The user must specifically request these relaxed
rules before a parser can accept such SMILES.</p><p>The following table lists "relaxed" rules that SMILES parsers may
accept.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Rule                 </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Example         </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Interpreted as …    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Details</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Extra parentheses</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C((C))O</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C(C)O</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Extra parentheses are ignored in places where there is no ambiguity as to the meaning.  Note that the form <code class="literal">(CO)N</code> is never allowed, since it isn’t clear which atom the nitrogen should connect to.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C((C))O</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C(C)O</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">(N1CCCC1)</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">N1CCCCC1</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Misplaced dots</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Na+]..[Cl-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[Na+].[Cl-]</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Two or more dot-bonds in a row are condensed into one.  A leading or trailing dot-bond is ignored.  Note that a dot that starts a branch is <span class="emphasis"><em>legal</em></span> in strict SMILES; for example, <code class="literal">C1CC(.[Na+])CC1[O-]</code> is a legal (though strange) SMILES.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">.CCO</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO.</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCO</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Mismatched Ring Bonds</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C1CCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CCCC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Mismatched ring bonds are ignored.  Note that this is almost always a bad idea.  For example, <code class="literal">C1CCCCC2</code> is almost certainly supposed to be cyclohexane <code class="literal">C1CCCCC1</code>, but with "relaxed" parsing would be interpreted as hexane.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Invalid Cis/Trans specification</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C/C=C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC=C</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="3" align="left" valign="top"><p>Mismatched or incomplete cis/trans bonds are ignored.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C/C=CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC=CC</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC/=C/C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC=CC</code></p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Conflicting cis/trans specification</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C/C(\F)=C/C</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC(F)=CC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Conflicting cis/trans bonds are ignored. (In this case, both the methyl and fluorine on the left are shown as <span class="emphasis"><em>trans</em></span> to the methyl on the right, an impossible configuration.)</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>D and T</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">D[CH3]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[2H][CH3]</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>The symbols <code class="literal">D</code> and <code class="literal">T</code> are treated as synonyms for <code class="literal">[2H]</code> and <code class="literal">[3H]</code>.</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">T[CH3]</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">[3H][CH3]</code></p></td></tr><tr><td style="" rowspan="2" align="left" valign="top"><p>Lowercase as sp<sup>2</sup></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CccccC</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">CC=CC=CC</code> 2,4-hexadiene</p></td><td style="" rowspan="2" align="left" valign="top"><p>Lowercase letters are interpreted as sp<sup>2</sup>, even outside of ring systems.</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">Ccc</code></p></td><td style="" align="left" valign="top"><p><code class="literal">CC=C</code> propene</p></td></tr></tbody></table></div></div><div class="section" title="6. Proposed Extensions"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_proposed_extensions"></a>6. Proposed Extensions</h2></div></div></div><div class="section" title="6.1. External R-Groups"><div class="titlepage"><div><div><h3 class="title"><a id="_external_r_groups"></a>6.1. External R-Groups</h3></div></div></div><p>Daylight proposed, and OpenEye actually implemented, an extension that
specifies bonds to external R-groups.  An external R-group is specified
using ampersand <code class="literal">'&amp;'</code> followed by a ring-closure specification (either a
digit, or <code class="literal">'%'</code> and two digits).  However, unlike ring-closures, the bond is to
an external, unspecified R-group.  Example: <code class="literal">n1c(&amp;1)c(&amp;2)cccc1</code> - 2,3-substituted pyridine.</p></div><div class="section" title="6.2. Polymers and Crystals"><div class="titlepage"><div><div><h3 class="title"><a id="_polymers_and_crystals"></a>6.2. Polymers and Crystals</h3></div></div></div><p>Daylight (Weininger) proposed, but never implemented, an extension for crystals and
polymers.  Daylight also used the ampersand <code class="literal">'&amp;'</code> character, (which may
conflict with the R-group proposal, above), but with the added rule that
if a number appears more than once, it creates a repeating unit.</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="40%"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES          </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">c1ccccc1C&amp;1&amp;1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>polystyrene</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">C&amp;1&amp;1&amp;1&amp;1</code></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>diamond</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">c&amp;1&amp;1&amp;1</code></p></td><td style="" align="left" valign="top"><p>graphite</p></td></tr></tbody></table></div></div><div class="section" title="6.3. '@' for Cis/Trans around Double Bonds"><div class="titlepage"><div><div><h3 class="title"><a id="_literal_literal_for_cis_trans_around_double_bonds"></a>6.3. <code class="literal">'@'</code> for Cis/Trans around Double Bonds</h3></div></div></div><p>The <code class="literal">'/'</code> and <code class="literal">'\'</code> marks for cis/trans bonds seem simple on the surface but
are problematic for complex systems.  For example, in a long series of
conjugated double bonds, changing the configuration of one bond can require
rewriting dozens of bond symbols.</p><p>More importantly, there is a theoretical flaw with the use of <code class="literal">'/'</code> and
<code class="literal">'\'</code>.  In a cyclo-ene (<span class="emphasis"><em>name??</em></span>) ring with an even number of double bonds, it is
not possible to write a valid SMILES.  (Recall that <code class="literal">'/'</code> and <code class="literal">'\'</code> reverse
sense if moved from the left to the right of the atom, thus <code class="literal">C/1=C/CCCCCCC1</code>
represents a cis configuration even though <code class="literal">'/'</code> appears twice.)</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                            </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Comment</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cyclooctatetraene.gif" alt="depict/cyclooctatetraene.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">C/1=C/C=C\C=C/C=C\1</code></p></td><td style="" align="left" valign="top"><p>Illegal SMILES</p></td></tr></tbody></table></div><p>The SMILES above is illegal because the first and second <code class="literal">C1</code> have
opposite bond symbols <code class="literal">'/'</code> versus <code class="literal">'\'</code>, so the single bond that was "broken"
to create the ring has to be both "up" and "down".  This logical
flaw follows from using "up" and "down" in a linear notation, when in
fact the atoms form a circle.</p><p>The proposed syntax for cis/trans configurations uses the <code class="literal">'@'</code> symbol on
the allenal atoms.  For example:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="90%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES              </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/trans-difluoroethene.gif" alt="depict/trans-difluoroethene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F[C@@H]=[C@H]F</code></p></td><td style="border-bottom: 1px solid #527bbd; " rowspan="2" align="left" valign="top"><p>trans-difluoroethene</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F[C@H]=[C@@H]F</code></p></td></tr><tr><td style="" rowspan="2" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cis-difluoroethene.gif" alt="depict/cis-difluoroethene.gif" /></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="literal">F[C@H]=[C@H]F</code></p></td><td style="" rowspan="2" align="left" valign="top"><p>cis-difluoroethene</p></td></tr><tr><td style="" align="left" valign="top"><p><code class="literal">F[C@@H]=[C@@H]F</code></p></td></tr></tbody></table></div><p>Interpretation of <code class="literal">'@'</code> and <code class="literal">'@@'</code> follows the tetrahedral convention:
The atoms, as encountered in the SMILES string, are either in anticlockwise
<code class="literal">'@'</code> or clockwise <code class="literal">'@@'</code> order as viewed on the page.  Since cis/trans
configurations are planar, they can also be "viewed from underneath the
page", which results in the two valid SMILES shown for each compound,
above.</p><p>Note that in all cases, cis and trans are easy for the chemist to
distinguish visually: A trans form always has opposite "clock-ness" (<code class="literal">@</code>,<code class="literal">@@</code> or
<code class="literal">@@</code>,<code class="literal">@</code>), and the cis form always has the same "clock-ness" (<code class="literal">@</code>,<code class="literal">@</code> or <code class="literal">@@</code>,<code class="literal">@@</code>) for
the allenal atoms.</p><p>This proposed form of cis/trans specification using <code class="literal">'@'</code> and <code class="literal">'@@'</code> does not suffer from the
theoretical flaw illustrated above:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Depiction                            </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> SMILES                                                  </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="" align="left" valign="top"><p><span class="inlinemediaobject"><img src="depict/cyclooctatetraene.gif" alt="depict/cyclooctatetraene.gif" /></span></p></td><td style="" align="left" valign="top"><p><code class="literal">[C@H]1=[C@@H][C@@H]=[C@@H][C@@H]=[C@@H][C@@H]=[C@@H]1</code></p></td><td style="" align="left" valign="top"><p>cyclooctatetraene</p></td></tr></tbody></table></div><p>Note that the first allenal carbon must be represented as <code class="literal">'@'</code> since the
<code class="literal">'1'</code> follows the <code class="literal">H</code>, whereas the rest of the allenal carbons use <code class="literal">'@@'</code> to
characterize the cis configuration of each bond.  Since this is a
specification on the atom, rather than the single bond, no conflict arises
at the ring-closure bond.</p></div><div class="section" title="6.4. Radical"><div class="titlepage"><div><div><h3 class="title"><a id="_radical"></a>6.4. Radical</h3></div></div></div><p><span class="emphasis"><em>This section needs considerable work.  The following text is courtesy Chris Morley, who
commented: "I guess the last paragraph doesn’t look too good in a formal specification. There are
two reasons for the frailty: lack of proof that the radical and aromatic uses can always be
unambigous (I doubt anybody has tried); and a known deficiency in the parser."  However, it is a
good starting point…</em></span></p><p>A single lowercase symbol is interpreted as a radical center. <code class="literal">CCc</code> is an alternative to <code class="literal">CC[CH2]</code> and
is the 1-propyl radical; <code class="literal">CcC</code> or <code class="literal">C[CH]C</code> is the 2-propyl radical, <code class="literal">Co</code> is the methoxy radical. An odd
number of adjacent lowercase symbols is a delocalised conjugated radical. So <code class="literal">Cccccc</code> is <code class="literal">CC=CC=C[CH2]</code>
or <code class="literal">CC=C[CH]C=C</code> or <code class="literal">C[CH]C=CC=C</code> Lowercase <code class="literal">'c'</code> or <code class="literal">'n'</code> can be used in a ring: <code class="literal">C1cCCCC1</code> is the cyclohexyl
radical.</p><p>The use of the non-aromatic lowercase symbol is a shorted form with improved intelligibilty that
allows the use of implicit hydrogen in radicals. However it is intended only for simple unambiguous
molecules and is not reliable when combined with aromatic atoms.</p></div><div class="section" title="6.5. Twisted SMILES"><div class="titlepage"><div><div><h3 class="title"><a id="_twisted_smiles"></a>6.5. Twisted SMILES</h3></div></div></div><p>An interesting extension that specifies conformational information via
bond dihedral angles and bond lengths was proposed by McLeod and Peters:</p><div class="sidebar"><div class="titlepage"></div><p><a class="ulink" href="http://www.daylight.com/meetings/mug03/McLeod/MUG03McLeodPeters.pdf" target="_top">http://www.daylight.com/meetings/mug03/McLeod/MUG03McLeodPeters.pdf</a></p></div></div></div><div class="section" title="7. APPENDIX 1: References and Citations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendix"></a>7. APPENDIX 1: References and Citations</h2></div></div></div><div class="section" title="7.1. Groups"><div class="titlepage"><div><div><h3 class="title"><a id="_groups"></a>7.1. Groups</h3></div></div></div><p><span class="strong"><strong>Blue Obelisk</strong></span></p><p><a class="ulink" href="http://blueobelisk.sourceforge.net/" target="_top">http://blueobelisk.sourceforge.net/</a></p></div><div class="section" title="7.2. Documentation"><div class="titlepage"><div><div><h3 class="title"><a id="_documentation"></a>7.2. Documentation</h3></div></div></div><p><span class="strong"><strong>Daylight</strong></span></p><p><a class="ulink" href="http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html" target="_top">http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html</a></p><p>The most-referenced definition of SMILES on the web.</p><p><a class="ulink" href="http://www.daylight.com/meetings/mug01/Sayle/m4xbondage.html" target="_top">http://www.daylight.com/meetings/mug01/Sayle/m4xbondage.html</a></p><p>Article by Roger Sayle about converting PDB files to SMILES with thorough treatment of aromaticity.</p><p><span class="strong"><strong>OpenEye</strong></span></p><p><a class="ulink" href="http://www.eyesopen.com/docs/html/pyprog/TheSMILESLineNotation.html" target="_top">http://www.eyesopen.com/docs/html/pyprog/TheSMILESLineNotation.html</a></p><p><a class="ulink" href="http://www.eyesopen.com/docs/html/pyprog/DaylightSMILES.html" target="_top">http://www.eyesopen.com/docs/html/pyprog/DaylightSMILES.html</a></p><p><span class="strong"><strong>OpenBabel</strong></span></p><p><a class="ulink" href="http://openbabel.sourceforge.net/wiki/Radicals_and_SMILES_extensions" target="_top">http://openbabel.sourceforge.net/wiki/Radicals_and_SMILES_extensions</a></p><p><a class="ulink" href="http://openbabel.sourceforge.net/wiki/SMILES" target="_top">http://openbabel.sourceforge.net/wiki/SMILES</a></p><p><span class="strong"><strong>Wikipedia</strong></span></p><p><a class="ulink" href="http://en.wikipedia.org/wiki/Simplified_molecular_input_line_entry_specification" target="_top">http://en.wikipedia.org/wiki/Simplified_molecular_input_line_entry_specification</a></p></div><div class="section" title="7.3. Toolkits"><div class="titlepage"><div><div><h3 class="title"><a id="_toolkits"></a>7.3. Toolkits</h3></div></div></div><p><span class="strong"><strong>OpenBabel</strong></span></p><p><a class="ulink" href="http://openbabel.sourceforge.net/wiki/Main_Page" target="_top">http://openbabel.sourceforge.net/wiki/Main_Page</a></p><p><span class="strong"><strong>The Chemistry Development Kit</strong></span></p><p><a class="ulink" href="http://cdk.sourceforge.net/" target="_top">http://cdk.sourceforge.net/</a></p><p><span class="strong"><strong>Marvin</strong></span></p><p><a class="ulink" href="http://www.chemaxon.com/marvin/doc/user/smiles-doc.html" target="_top">http://www.chemaxon.com/marvin/doc/user/smiles-doc.html</a></p><p><span class="strong"><strong>RDKit</strong></span></p><p><a class="ulink" href="http://www.rdkit.org/" target="_top">http://www.rdkit.org/</a></p><p><span class="strong"><strong>Frowns</strong></span></p><p><a class="ulink" href="http://frowns.sourceforge.net/frowns.html" target="_top">http://frowns.sourceforge.net/frowns.html</a></p><p><span class="strong"><strong>PerlMol.org</strong></span></p><p><a class="ulink" href="http://search.cpan.org/~itub/Chemistry-File-SMILES-0.45/SMILES.pm" target="_top">http://search.cpan.org/\~itub/Chemistry-File-SMILES-0.45/SMILES.pm</a></p><p><span class="strong"><strong>InChI</strong></span></p><p><a class="ulink" href="http://www.iupac.org/inchi/" target="_top">http://www.iupac.org/inchi/</a></p><p><a class="ulink" href="http://inchi.info/" target="_top">http://inchi.info/</a></p><p><a class="ulink" href="http://en.wikipedia.org/wiki/International_Chemical_Identifier" target="_top">http://en.wikipedia.org/wiki/International_Chemical_Identifier</a></p></div><div class="section" title="7.4. Some Key Scientific Papers"><div class="titlepage"><div><div><h3 class="title"><a id="_some_key_scientific_papers"></a>7.4. Some Key Scientific Papers</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
David Weininger, SMILES, a Chemical Language and Information System. 1. Introduction to Methodology and Encoding Rules,
Journal of Chemical Information and Computer Sciences, 1988, 28:31-36.
</li><li class="listitem">
David Weininger, Arthur Weininger, and Joseph L Weininger,
SMILES 2. Algorithm for Generation of Unique SMILES Notation
Journal of Chemical Information and Computer Sciences, 1989, 29:97-101.
</li><li class="listitem">
Morgan’s original canonicalization paper: Morgan, H.L. J.Chem.Doc. 1965, 5, 107
</li><li class="listitem">
G.M. Downs et al, Review of Ring Perception Algorithms for Chemical Graphs, J. Chem. Inf. Comput. Cci. 1989, 29, 172-187
</li><li class="listitem">
R.Balducci and R, Pearlman, Novel Algorithms for the Rapid Perception of a Unique Optimal Set of Rings, J. Am. Chem. Soc. (date?)
</li></ul></div></div><div class="section" title="7.5. Molecule Editors that can produce SMILES"><div class="titlepage"><div><div><h3 class="title"><a id="_molecule_editors_that_can_produce_smiles"></a>7.5. Molecule Editors that can produce SMILES</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="ulink" href="http://www.metamolecular.com" target="_top">ChemWriter</a>
</li><li class="listitem">
JME
</li><li class="listitem">
CACTVS
</li><li class="listitem">
ISISDraw?
</li><li class="listitem">
ChemDraw
</li><li class="listitem">
ACD/ChemSketch
</li><li class="listitem">
<a class="ulink" href="http://www.chemaxon.com/product/msketch.html" target="_top">MarvinSketch</a>
</li></ul></div></div></div><div class="section" title="8. Revision History"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_revision_history"></a>8. Revision History</h2></div></div></div><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Revision </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Date </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Description </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Name</th></tr></thead><tbody><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1.0</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2007-11-13</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Draft</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Craig A. James</p></td></tr><tr><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>1.0</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>2012-09-29</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Reformatting</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Tim Vandermeersch</p></td></tr><tr><td style="" align="left" valign="top"><p>1.0</p></td><td style="" align="left" valign="top"><p>2012-09-29</p></td><td style="" align="left" valign="top"><p>Corrections</p></td><td style="" align="left" valign="top"><p>Andrew Dalke &amp; Tim Vandermeersch</p></td></tr></tbody></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="ulink" href="https://github.com/timvdm/OpenSMILES/blob/master/ChangeLog" target="_top">ChangeLog</a>
</li><li class="listitem">
<a class="ulink" href="https://github.com/timvdm/OpenSMILES/blob/master/discussion_summary.txt" target="_top">Discussion Summary</a>
</li></ul></div></div></div></body></html>
